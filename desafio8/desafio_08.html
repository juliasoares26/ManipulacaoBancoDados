<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Análise Automatizada">

<title>Análise do Banco de Dados UW-Madison - Disciplinas de Estatística</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="desafio_08_files/libs/clipboard/clipboard.min.js"></script>
<script src="desafio_08_files/libs/quarto-html/quarto.js"></script>
<script src="desafio_08_files/libs/quarto-html/popper.min.js"></script>
<script src="desafio_08_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="desafio_08_files/libs/quarto-html/anchor.min.js"></script>
<link href="desafio_08_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="desafio_08_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="desafio_08_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="desafio_08_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="desafio_08_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análise do Banco de Dados UW-Madison - Disciplinas de Estatística</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Análise Automatizada </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="informações-de-geração" class="level2">
<h2 class="anchored" data-anchor-id="informações-de-geração">Informações de Geração</h2>
<p><strong>Documento gerado em:</strong> 24 de setembro de 2025 às 21:17:02 (-03)<br>
<strong>Sistema:</strong> Windows<br>
<strong>Versão do R:</strong> R version 4.4.2 (2024-10-31 ucrt)</p>
<hr>
</section>
<section id="introdução" class="level2">
<h2 class="anchored" data-anchor-id="introdução">Introdução</h2>
<p>Este documento apresenta a análise <strong>completamente corrigida</strong> do banco de dados SQLite da UW-Madison, focando em disciplinas de Estatística. Todas as correções de sintaxe foram aplicadas.</p>
</section>
<section id="configuração-inicial" class="level2">
<h2 class="anchored" data-anchor-id="configuração-inicial">Configuração Inicial</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Registrar início da análise</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>inicio_analise <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Análise iniciada em:"</span>, <span class="fu">format</span>(inicio_analise, <span class="st">'%d/%m/%Y às %H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Análise iniciada em: 24/09/2025 às 21:17:02 </code></pre>
</div>
</div>
</section>
<section id="verificando-e-extraindo-o-arquivo-zip-se-necessário" class="level1">
<h1>Verificando e extraindo o arquivo ZIP se necessário</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"archive.zip"</span>)) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Arquivo archive.zip não encontrado. Por favor, faça o download primeiro."</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"uwmadison.sqlite3"</span>)) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Extraindo arquivo ZIP...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unzip</span>(<span class="st">"archive.zip"</span>, <span class="at">exdir =</span> <span class="st">"."</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  arquivos_sqlite <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">"*.sqlite3|*.db"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(arquivos_sqlite) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="st">"uwmadison.sqlite3"</span> <span class="sc">%in%</span> arquivos_sqlite) {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">file.copy</span>(arquivos_sqlite[<span class="dv">1</span>], <span class="st">"uwmadison.sqlite3"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Arquivo SQLite pronto!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Arquivo SQLite pronto!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Timestamp:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Timestamp: 21:17:02 </code></pre>
</div>
</div>
<section id="diagnóstico-da-estrutura" class="level2">
<h2 class="anchored" data-anchor-id="diagnóstico-da-estrutura">Diagnóstico da Estrutura</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"uwmadison.sqlite3"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== DIAGNÓSTICO AUTOMÁTICO ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== DIAGNÓSTICO AUTOMÁTICO ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Executado em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%d/%m/%Y às %H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Executado em: 24/09/2025 às 21:17:02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tabelas <span class="ot">&lt;-</span> <span class="fu">dbListTables</span>(conn)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabelas disponíveis:"</span>, <span class="fu">paste</span>(tabelas, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tabelas disponíveis: course_offerings, courses, grade_distributions, instructors, rooms, schedules, sections, subject_memberships, subjects, teachings </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>diagnosticar_tabela <span class="ot">&lt;-</span> <span class="cf">function</span>(nome_tabela) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>nome_tabela <span class="sc">%in%</span> tabelas) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Tabela '%s' não encontrada</span><span class="sc">\n</span><span class="st">"</span>, nome_tabela))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  estrutura <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="fu">sprintf</span>(<span class="st">"PRAGMA table_info(%s)"</span>, nome_tabela))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="fu">sprintf</span>(<span class="st">"SELECT COUNT(*) as total FROM %s"</span>, nome_tabela))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- %s ---</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">toupper</span>(nome_tabela)))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Colunas: %s</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">paste</span>(estrutura<span class="sc">$</span>name, <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Registros: %d</span><span class="sc">\n</span><span class="st">"</span>, total<span class="sc">$</span>total))</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  pk <span class="ot">&lt;-</span> estrutura[estrutura<span class="sc">$</span>pk <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"name"</span>]</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(pk) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Chave primária: %s</span><span class="sc">\n</span><span class="st">"</span>, pk[<span class="dv">1</span>]))</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estrutura =</span> estrutura, <span class="at">total =</span> total<span class="sc">$</span>total, <span class="at">pk =</span> <span class="cf">if</span>(<span class="fu">length</span>(pk) <span class="sc">&gt;</span> <span class="dv">0</span>) pk[<span class="dv">1</span>] <span class="cf">else</span> <span class="cn">NULL</span>))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>estruturas <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>tabelas_principais <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"subjects"</span>, <span class="st">"instructors"</span>, <span class="st">"courses"</span>, <span class="st">"course_offerings"</span>, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"grade_distributions"</span>, <span class="st">"teachings"</span>, <span class="st">"subject_memberships"</span>, <span class="st">"sections"</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (tab <span class="cf">in</span> tabelas_principais) {</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  estruturas[[tab]] <span class="ot">&lt;-</span> <span class="fu">diagnosticar_tabela</span>(tab)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- SUBJECTS ---
Colunas: code, name, abbreviation
Registros: 200

--- INSTRUCTORS ---
Colunas: id, name
Registros: 18738

--- COURSES ---
Colunas: uuid, name, number
Registros: 9306

--- COURSE_OFFERINGS ---
Colunas: uuid, course_uuid, term_code, name
Registros: 81453

--- GRADE_DISTRIBUTIONS ---
Colunas: course_offering_uuid, section_number, n_count, c_count, f_count, cr_count, p_count, nw_count, other_count, bc_count, u_count, d_count, ab_count, a_count, s_count, i_count, b_count, nr_count
Registros: 193262

--- TEACHINGS ---
Colunas: instructor_id, section_uuid
Registros: 315211

--- SUBJECT_MEMBERSHIPS ---
Colunas: subject_code, course_offering_uuid
Registros: 95314

--- SECTIONS ---
Colunas: uuid, course_offering_uuid, section_type, number, room_uuid, schedule_uuid
Registros: 370771</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A chave primária de course_offerings é 'uuid' (corrigido)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>co_key <span class="ot">&lt;-</span> <span class="st">"uuid"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Usando chave para course_offerings: %s</span><span class="sc">\n</span><span class="st">"</span>, co_key))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Usando chave para course_offerings: uuid</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testar conectividade das tabelas</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== TESTE DE CONECTIVIDADE ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== TESTE DE CONECTIVIDADE ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>test_query <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT COUNT(*) as total</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM course_offerings co</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 1</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  test_result <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, test_query)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Conectividade OK: %d registros vinculados</span><span class="sc">\n</span><span class="st">"</span>, test_result<span class="sc">$</span>total))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro de conectividade: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conectividade OK: 95314 registros vinculados</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Diagnóstico concluído em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diagnóstico concluído em: 21:17:02 </code></pre>
</div>
</div>
</section>
<section id="investigação-de-códigos-de-estatística" class="level2">
<h2 class="anchored" data-anchor-id="investigação-de-códigos-de-estatística">Investigação de Códigos de Estatística</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== PROCURANDO CÓDIGOS DE ESTATÍSTICA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== PROCURANDO CÓDIGOS DE ESTATÍSTICA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Timestamp:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Timestamp: 21:17:03 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>stat_variants <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT code, name, abbreviation, </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">       (SELECT COUNT(*) FROM subject_memberships sm WHERE sm.subject_code = s.code) as oferecimentos</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM subjects s</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE UPPER(s.name) LIKE '%STAT%' </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">   OR UPPER(s.abbreviation) LIKE '%STAT%'</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">   OR s.code = 'STAT'</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY oferecimentos DESC</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Códigos relacionados a Estatística:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Códigos relacionados a Estatística:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stat_variants)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  code                                  name abbreviation oferecimentos
1  932                            Statistics         STAT           747
2  239  Real Estate and Urban Land Economics     REAL EST           353
3  210 Biostatistics and Medical Informatics        B M I           199</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(stat_variants) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> stat_variants<span class="sc">$</span>oferecimentos[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  codigo_estatistica <span class="ot">&lt;-</span> stat_variants<span class="sc">$</span>code[<span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Usando código: %s (%s) com %d oferecimentos</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>              codigo_estatistica, stat_variants<span class="sc">$</span>name[<span class="dv">1</span>], stat_variants<span class="sc">$</span>oferecimentos[<span class="dv">1</span>]))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Nenhum código específico de estatística encontrado.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"vamos usar o código mais comum para demonstração:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  top_codes <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT sm.subject_code, s.name, COUNT(*) as total</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM subject_memberships sm</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN subjects s ON sm.subject_code = s.code</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY sm.subject_code, s.name</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY total DESC</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="st">  LIMIT 5</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(top_codes)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(top_codes) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    codigo_estatistica <span class="ot">&lt;-</span> top_codes<span class="sc">$</span>subject_code[<span class="dv">1</span>]</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Usando código mais popular para demonstração: %s</span><span class="sc">\n</span><span class="st">"</span>, codigo_estatistica))</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Usando código: 932 (Statistics) com 747 oferecimentos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Busca concluída em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Busca concluída em: 21:17:03 </code></pre>
</div>
</div>
</section>
<section id="atividade-1-professores-de-estatística" class="level2">
<h2 class="anchored" data-anchor-id="atividade-1-professores-de-estatística">Atividade 1: Professores de Estatística</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== PROFESSORES DE ESTATÍSTICA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== PROFESSORES DE ESTATÍSTICA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Iniciado em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iniciado em: 21:17:03 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Query corrigida com JOINs apropriados</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  query_professores <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">      i.name as professor_nome, </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="st">      i.id as professor_id,</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="st">      COUNT(DISTINCT co.uuid) as num_oferecimentos</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM instructors i</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN teachings t ON i.id = t.instructor_id</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN sections s ON t.section_uuid = s.uuid  </span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN course_offerings co ON s.course_offering_uuid = co.uuid</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sm.subject_code = '%s'</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY i.name, i.id</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY num_oferecimentos DESC, i.name</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>, codigo_estatistica)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Query sendo executada:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(query_professores, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    professores_stat <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_professores)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(professores_stat) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"SUCESSO! Professores encontrados:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable</span>(professores_stat)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Total de professores: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(professores_stat)))</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Nenhum professor encontrado para o código selecionado.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro na query: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Query alternativa mais simples</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Tentando query alternativa...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    query_alt <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT DISTINCT i.name as professor_nome, i.id as professor_id</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM instructors i</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN teachings t ON i.id = t.instructor_id</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="st">    LIMIT 10</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    result_alt <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_alt)</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(result_alt) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Estrutura básica OK. Problema está nos JOINs específicos.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable</span>(result_alt)</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Código de estatística não definido.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Query sendo executada:

  SELECT DISTINCT 
      i.name as professor_nome, 
      i.id as professor_id,
      COUNT(DISTINCT co.uuid) as num_oferecimentos
  FROM instructors i
  INNER JOIN teachings t ON i.id = t.instructor_id
  INNER JOIN sections s ON t.section_uuid = s.uuid  
  INNER JOIN course_offerings co ON s.course_offering_uuid = co.uuid
  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid
  WHERE sm.subject_code = '932'
  GROUP BY i.name, i.id
  ORDER BY num_oferecimentos DESC, i.name
   

SUCESSO! Professores encontrados:

 Total de professores: 379</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Atividade 1 concluída em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Atividade 1 concluída em: 21:17:05 </code></pre>
</div>
</div>
</section>
<section id="atividade-2-análise-de-gpa" class="level2">
<h2 class="anchored" data-anchor-id="atividade-2-análise-de-gpa">Atividade 2: Análise de GPA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== ANÁLISE DE GPA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== ANÁLISE DE GPA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Iniciado em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iniciado em: 21:17:05 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Query corrigida: gd.course_offering_uuid = co.uuid</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  test_grade_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) as total</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM grade_distributions gd</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN course_offerings co ON gd.course_offering_uuid = co.uuid</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid  </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sm.subject_code = '%s'</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>, codigo_estatistica))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Oferecimentos com dados de notas para %s: %d</span><span class="sc">\n</span><span class="st">"</span>, codigo_estatistica, test_grade_data<span class="sc">$</span>total))</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (test_grade_data<span class="sc">$</span>total <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Query principal corrigida</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    query_gpa <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT </span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="st">        c.name as disciplina,</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="st">        c.number as numero,</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="st">        co.term_code,</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="st">        co.name as oferecimento_nome,</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.a_count, 0) AS INTEGER) as a_count,</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.ab_count, 0) AS INTEGER) as ab_count,</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.b_count, 0) AS INTEGER) as b_count,</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.bc_count, 0) AS INTEGER) as bc_count,</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.c_count, 0) AS INTEGER) as c_count,</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.d_count, 0) AS INTEGER) as d_count,</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.f_count, 0) AS INTEGER) as f_count,</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="st">        (CAST(COALESCE(gd.a_count, 0) AS INTEGER) + </span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(COALESCE(gd.ab_count, 0) AS INTEGER) + </span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(COALESCE(gd.b_count, 0) AS INTEGER) + </span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(COALESCE(gd.bc_count, 0) AS INTEGER) + </span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(COALESCE(gd.c_count, 0) AS INTEGER) + </span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(COALESCE(gd.d_count, 0) AS INTEGER) + </span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(COALESCE(gd.f_count, 0) AS INTEGER)) as total_estudantes,</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="st">        CASE </span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="st">          WHEN (CAST(COALESCE(gd.a_count, 0) AS INTEGER) + </span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.ab_count, 0) AS INTEGER) + </span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.b_count, 0) AS INTEGER) + </span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.bc_count, 0) AS INTEGER) + </span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.c_count, 0) AS INTEGER) + </span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.d_count, 0) AS INTEGER) + </span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.f_count, 0) AS INTEGER)) &gt; 0</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="st">          THEN ROUND(</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="st">              (CAST(COALESCE(gd.a_count, 0) AS REAL) * 4.0 + </span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.ab_count, 0) AS REAL) * 3.5 + </span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.b_count, 0) AS REAL) * 3.0 + </span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.bc_count, 0) AS REAL) * 2.5 + </span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.c_count, 0) AS REAL) * 2.0 + </span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.d_count, 0) AS REAL) * 1.0 + </span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.f_count, 0) AS REAL) * 0.0) / </span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="st">              (CAST(COALESCE(gd.a_count, 0) AS REAL) + </span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.ab_count, 0) AS REAL) + </span></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.b_count, 0) AS REAL) + </span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.bc_count, 0) AS REAL) + </span></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.c_count, 0) AS REAL) + </span></span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.d_count, 0) AS REAL) + </span></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="st">               CAST(COALESCE(gd.f_count, 0) AS REAL)), 3)</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a><span class="st">          ELSE NULL</span></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="st">        END as gpa_medio</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM grade_distributions gd</span></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN course_offerings co ON gd.course_offering_uuid = co.uuid</span></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN courses c ON co.course_uuid = c.uuid</span></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE sm.subject_code = '%s'</span></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="st">      AND (CAST(COALESCE(gd.a_count, 0) AS INTEGER) + </span></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="st">           CAST(COALESCE(gd.ab_count, 0) AS INTEGER) + </span></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="st">           CAST(COALESCE(gd.b_count, 0) AS INTEGER) + </span></span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a><span class="st">           CAST(COALESCE(gd.bc_count, 0) AS INTEGER) + </span></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a><span class="st">           CAST(COALESCE(gd.c_count, 0) AS INTEGER) + </span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a><span class="st">           CAST(COALESCE(gd.d_count, 0) AS INTEGER) + </span></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a><span class="st">           CAST(COALESCE(gd.f_count, 0) AS INTEGER)) &gt; 0</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a><span class="st">    ORDER BY gpa_medio ASC</span></span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>, codigo_estatistica)</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>      dados_gpa <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_gpa)</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(dados_gpa) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Dados de GPA calculados com sucesso!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Total de oferecimentos analisados: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(dados_gpa)))</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Primeiros resultados (ordenados por dificuldade):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>        <span class="fu">kable</span>(<span class="fu">head</span>(dados_gpa, <span class="dv">10</span>))</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>        gpas_validos <span class="ot">&lt;-</span> dados_gpa<span class="sc">$</span>gpa_medio[<span class="sc">!</span><span class="fu">is.na</span>(dados_gpa<span class="sc">$</span>gpa_medio)]</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(gpas_validos) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>          idx_min <span class="ot">&lt;-</span> <span class="fu">which.min</span>(dados_gpa<span class="sc">$</span>gpa_medio)</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>          idx_max <span class="ot">&lt;-</span> <span class="fu">which.max</span>(dados_gpa<span class="sc">$</span>gpa_medio)</span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Estatísticas de GPA:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"• GPA mais baixo: %.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">min</span>(gpas_validos)))</span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"• GPA mais alto: %.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">max</span>(gpas_validos)))</span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"• GPA médio: %.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">mean</span>(gpas_validos)))</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> DISCIPLINA MAIS DIFÍCIL: %s %s (GPA: %.3f)</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>                      dados_gpa<span class="sc">$</span>numero[idx_min], dados_gpa<span class="sc">$</span>disciplina[idx_min], dados_gpa<span class="sc">$</span>gpa_medio[idx_min]))</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"DISCIPLINA MAIS FÁCIL: %s %s (GPA: %.3f)</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a>                      dados_gpa<span class="sc">$</span>numero[idx_max], dados_gpa<span class="sc">$</span>disciplina[idx_max], dados_gpa<span class="sc">$</span>gpa_medio[idx_max]))</span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Nenhum dado de GPA encontrado.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro na análise GPA: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Nenhum oferecimento com dados de notas encontrado.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Código de estatística não definido.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oferecimentos com dados de notas para 932: 1716
Dados de GPA calculados com sucesso!
Total de oferecimentos analisados: 1057

Primeiros resultados (ordenados por dificuldade):

Estatísticas de GPA:
• GPA mais baixo: 2.305
• GPA mais alto: 4.000
• GPA médio: 3.356

 DISCIPLINA MAIS DIFÍCIL: 301 Introduction to Statistical Methods (GPA: 2.305)
DISCIPLINA MAIS FÁCIL: 998 Statistical Consulting (GPA: 4.000)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Atividade 2 concluída em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Atividade 2 concluída em: 21:17:05 </code></pre>
</div>
</div>
</section>
<section id="atividade-3-ranking-de-professores-por-gpa" class="level2">
<h2 class="anchored" data-anchor-id="atividade-3-ranking-de-professores-por-gpa">Atividade 3: Ranking de Professores por GPA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== RANKING DE PROFESSORES POR GPA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== RANKING DE PROFESSORES POR GPA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Iniciado em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iniciado em: 21:17:05 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  query_ranking <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="st">      i.name AS professor_nome,</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="st">      COUNT(DISTINCT gd.course_offering_uuid) AS num_oferecimentos,</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="st">      ROUND(AVG(</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="st">        CASE </span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="st">          WHEN (COALESCE(gd.a_count,0) + COALESCE(gd.ab_count,0) + COALESCE(gd.b_count,0) + </span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="st">                COALESCE(gd.bc_count,0) + COALESCE(gd.c_count,0) + COALESCE(gd.d_count,0) + </span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="st">                COALESCE(gd.f_count,0)) &gt; 0</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="st">          THEN</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="st">            (COALESCE(gd.a_count,0)*4.0 + COALESCE(gd.ab_count,0)*3.5 + COALESCE(gd.b_count,0)*3.0 + </span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="st">             COALESCE(gd.bc_count,0)*2.5 + COALESCE(gd.c_count,0)*2.0 + COALESCE(gd.d_count,0)*1.0 + </span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="st">             COALESCE(gd.f_count,0)*0.0) /</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="st">            (COALESCE(gd.a_count,0) + COALESCE(gd.ab_count,0) + COALESCE(gd.b_count,0) + </span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="st">             COALESCE(gd.bc_count,0) + COALESCE(gd.c_count,0) + COALESCE(gd.d_count,0) + </span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="st">             COALESCE(gd.f_count,0))</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="st">          ELSE NULL</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="st">        END</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="st">      ), 3) AS gpa_medio_professor,</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="st">      SUM(COALESCE(gd.a_count,0) + COALESCE(gd.ab_count,0) + COALESCE(gd.b_count,0) + </span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="st">          COALESCE(gd.bc_count,0) + COALESCE(gd.c_count,0) + COALESCE(gd.d_count,0) + </span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="st">          COALESCE(gd.f_count,0)) AS total_estudantes_ensinados</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM grade_distributions gd</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN course_offerings co ON gd.course_offering_uuid = co.uuid</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN sections s ON co.uuid = s.course_offering_uuid</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN teachings t ON s.uuid = t.section_uuid</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN instructors i ON t.instructor_id = i.id</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sm.subject_code = '%s'</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY i.name, i.id</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING COUNT(DISTINCT gd.course_offering_uuid) &gt;= 1</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY gpa_medio_professor ASC</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>, codigo_estatistica)</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>    ranking_professores <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_ranking)</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(ranking_professores) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"RANKING CALCULADO:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">kable</span>(ranking_professores))</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Identificar professor mais difícil (menor GPA) e mais fácil (maior GPA)</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>      idx_min <span class="ot">&lt;-</span> <span class="fu">which.min</span>(ranking_professores<span class="sc">$</span>gpa_medio_professor)</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>      idx_max <span class="ot">&lt;-</span> <span class="fu">which.max</span>(ranking_professores<span class="sc">$</span>gpa_medio_professor)</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>      professor_dificil <span class="ot">&lt;-</span> ranking_professores[idx_min, ]</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>      professor_facil   <span class="ot">&lt;-</span> ranking_professores[idx_max, ]</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Professor considerado MAIS DIFÍCIL:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- %s (GPA médio = %.2f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>                  professor_dificil<span class="sc">$</span>professor_nome, professor_dificil<span class="sc">$</span>gpa_medio_professor))</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Professor considerado MAIS FÁCIL:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- %s (GPA médio = %.2f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>                  professor_facil<span class="sc">$</span>professor_nome, professor_facil<span class="sc">$</span>gpa_medio_professor))</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">" Nenhum professor encontrado com dados suficientes.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro no ranking: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">" Código de estatística não definido.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RANKING CALCULADO:


|professor_nome                | num_oferecimentos| gpa_medio_professor| total_estudantes_ensinados|
|:-----------------------------|-----------------:|-------------------:|--------------------------:|
|CHRISTINE SORKNESS            |                 1|                  NA|                          0|
|GUILHERME ROSA                |                 1|                  NA|                          0|
|MARIAN R FISHER               |                 2|                  NA|                          0|
|MICHAEL RENE KOSOROK          |                 4|                  NA|                          0|
|NATALIA DE LEON GATTI         |                 1|                  NA|                          0|
|JAMES D KUELBS                |                 1|               2.599|                         65|
|JONATHON PETERSON             |                 1|               2.777|                         65|
|XIUFENG SHAO                  |                 1|               2.779|                        104|
|ALEXANDER FISH                |                 1|               2.807|                         75|
|KAILEI CHEN                   |                 1|               2.808|                        492|
|GINA OH                       |                 1|               2.829|                       1236|
|MANJUSHA KANCHARLA            |                 1|               2.829|                       1236|
|MITCHELL PAUKNER              |                 1|               2.829|                       1236|
|SHENG WANG                    |                 1|               2.829|                       1236|
|XIAOWU DAI                    |                 1|               2.829|                        824|
|JUNGWON MUN                   |                 2|               2.830|                        656|
|STEPHEN WAINGER               |                 2|               2.831|                        135|
|SCOTT HOTTOVY                 |                 1|               2.845|                        145|
|ALEXANDER KISELEV             |                 3|               2.846|                        226|
|DAVID GRIFFEATH               |                13|               2.851|                        658|
|HAODA FU                      |                 3|               2.853|                       1728|
|BROOK LUERS                   |                 3|               2.879|                       3338|
|GREGORY SHINAULT              |                 7|               2.880|                        986|
|ZHENGXIAO WU                  |                 2|               2.880|                       2793|
|KYLE HERBET                   |                 1|               2.890|                       1752|
|MARIA KAMENETSKY              |                 1|               2.890|                       1168|
|ANATOLE BECK                  |                 1|               2.917|                         73|
|BIN DAI                       |                 3|               2.921|                        678|
|TONGHAI YANG                  |                 4|               2.929|                        266|
|FLORIAN BERTRAND              |                 1|               2.936|                        102|
|ROBERT HARRON                 |                 1|               2.942|                         43|
|BO HUANG                      |                 1|               2.947|                       3016|
|JUN ZHANG                     |                 3|               2.948|                       5326|
|GINA BENNINGER                |                 8|               2.950|                       8047|
|YING ZHANG                    |                 3|               2.950|                       4746|
|LAM HO                        |                 2|               2.951|                        856|
|XIRAN WANG                    |                 3|               2.954|                       2512|
|ERICA LEE DEADMAN             |                 3|               2.961|                       3966|
|LIN QI                        |                 1|               2.963|                       1096|
|BEN ADAM HAALAND              |                 1|               2.964|                       2235|
|ELOISA D CHAVAS               |                 1|               2.964|                        745|
|MIN JUNG LEE                  |                 1|               2.964|                       1490|
|SCOTT JOSEPH HETZEL           |                 1|               2.964|                       1490|
|THOMAS G. KURTZ               |                11|               2.965|                        260|
|RUIFANG SONG                  |                 1|               2.971|                        145|
|GARY HOWARD SCHROEDER         |                 2|               2.972|                        790|
|CHEN JING                     |                 4|               2.976|                       6637|
|XIWEN MA                      |                 2|               2.978|                        920|
|JENNIFER NGUYEN               |                 2|               2.982|                       1185|
|XIAO NIE                      |                 5|               2.982|                       4246|
|STEFFEN LEMPP                 |                 2|               2.983|                        290|
|HEATHER MARIE BRAZEAU         |                 3|               2.988|                       4607|
|PHILIP WOOD                   |                 5|               2.991|                        451|
|VICTOR LUO                    |                 4|               2.993|                       3253|
|MIHAELA IFRIM                 |                 1|               2.995|                        290|
|SONA Z SWANSON                |                 1|               2.996|                       1364|
|IAN BRANSTAD RILEY            |                 2|               2.999|                       1748|
|STEPHEN BERG                  |                 2|               3.001|                       2163|
|GREGORIO MORENO-FLORES        |                 1|               3.007|                        206|
|SUKHENDU MEHROTRA             |                 1|               3.007|                        103|
|ALBERTO DEL PIA               |                 1|               3.008|                         59|
|DAVID ANDERSON                |                10|               3.008|                        841|
|HUILIN HU                     |                 1|               3.008|                         59|
|YUAN JIANG                    |                 4|               3.010|                       2941|
|SAMUEL STECHMANN              |                 1|               3.011|                        115|
|YALI WANG                     |                 2|               3.011|                       1545|
|MICHAEL FERRIS                |                10|               3.013|                        400|
|YUANZHI LI                    |                 5|               3.014|                       6538|
|YUCHEN ZHOU                   |                 3|               3.016|                       2446|
|DONG XIA                      |                 5|               3.019|                       1241|
|TAERI UHM                     |                 2|               3.020|                        280|
|XU HE                         |                 2|               3.030|                       2358|
|KUNLING HUANG                 |                 4|               3.031|                       3051|
|RICHARD A BRUALDI             |                 1|               3.031|                         32|
|GENG LI                       |                 2|               3.032|                       2446|
|YUJIN CHUNG                   |                 3|               3.032|                        223|
|LONG PHAN                     |                 6|               3.033|                       8528|
|WAI TONG FAN                  |                 3|               3.037|                        283|
|JASON RICHARD SWANSON         |                 2|               3.038|                         94|
|CHENXI LI                     |                 4|               3.039|                       5487|
|TIEN VO                       |                 2|               3.041|                       3196|
|ARNOLD MILLER                 |                 2|               3.042|                         70|
|VARSHA KULKARNI               |                 2|               3.042|                       1742|
|XINYU SONG                    |                14|               3.045|                      10405|
|MICHAEL GEORGE ILTIS          |                 2|               3.047|                        312|
|SANGBUM CHOI                  |                 6|               3.050|                      10943|
|ZHONGJIE YU                   |                 3|               3.051|                       4902|
|WESLEY CHANG                  |                 5|               3.052|                       6029|
|KEVIN PACKARD                 |                11|               3.053|                       7887|
|LANCINE KONATE                |                 1|               3.057|                         88|
|GUN WOONG PARK                |                 7|               3.062|                       6881|
|SHIXUE LIU                    |                 4|               3.062|                       7455|
|DIETRICH UHLENBROCK           |                 1|               3.063|                         27|
|LEV BORISOV                   |                 1|               3.063|                         27|
|NICHOLAS STEPHEN KEULER       |                22|               3.064|                       4353|
|YIFAN MEI                     |                 4|               3.070|                       1009|
|YOUNG MIN PARK                |                 4|               3.070|                       2490|
|STEVEN SAM                    |                 1|               3.071|                         35|
|ANDREW LESLIE                 |                 2|               3.072|                       3288|
|DANIELE CAPPELLETTI           |                 4|               3.073|                        455|
|BINGYING XIE                  |                 5|               3.074|                       6173|
|CUIZE HAN                     |                 9|               3.077|                       4054|
|YONGFENG WU                   |                 5|               3.077|                       3280|
|YUAN WANG                     |                 7|               3.078|                       2565|
|HAOYANG FAN                   |                 7|               3.082|                       9084|
|JOHN WILTSHIRE-GORDON         |                 1|               3.082|                         85|
|PAUL M TERWILLIGER            |                 7|               3.082|                        335|
|RUI CHEN                      |                 3|               3.083|                       2481|
|RUIFENG XU                    |                 2|               3.085|                       1056|
|JEEA CHOI                     |                 2|               3.086|                        355|
|RICHARD A. JOHNSON            |                 8|               3.087|                       1696|
|SHENG WANG                    |                10|               3.087|                      10891|
|SHIZHEN WANG                  |                 5|               3.087|                       3156|
|DEYUAN JIANG                  |                 6|               3.091|                       5614|
|TIMOTHY IDOWU                 |                 8|               3.092|                       4002|
|SEULKEE YUN                   |                 5|               3.094|                       3697|
|ANDREJ ZLATOS                 |                 1|               3.096|                         84|
|CRYSTAL CHEN                  |                 5|               3.096|                       6162|
|DONGHYUN LEE                  |                 1|               3.096|                         84|
|HUIKUN ZHANG                  |                 4|               3.097|                       2983|
|SEHO PARK                     |                 4|               3.097|                       3870|
|YU QIU LIU                    |                 4|               3.097|                       4446|
|JINGCI MENG                   |                 7|               3.101|                       9135|
|CHEN CHENG                    |                 9|               3.102|                       7876|
|ISMOR FISCHER                 |                31|               3.103|                      17472|
|SHI JIN                       |                 1|               3.104|                         48|
|LUXI CAO                      |                 5|               3.105|                        719|
|TIMO SEPPALAINEN              |                19|               3.106|                       1153|
|FANG FANG                     |                 4|               3.110|                       1057|
|ALEXANDER COVINGTON           |                 3|               3.112|                       2656|
|PERLA REYES                   |                 6|               3.112|                       9289|
|XIN LI                        |                 5|               3.113|                       6302|
|STEPHEN WRIGHT                |                14|               3.114|                        639|
|MIN NIU                       |                 4|               3.118|                       5881|
|YAOGUO XIE                    |                11|               3.118|                       5600|
|YOUNGDEOK HWANG               |                 8|               3.119|                       6770|
|CHIEN-WEI CHEN                |                 4|               3.121|                       2303|
|JUNHEE HAN                    |                 2|               3.123|                        708|
|KYLE HEBERT                   |                 3|               3.123|                       1443|
|BOWEN HU                      |                 4|               3.125|                       3231|
|DONALD PORTER                 |                28|               3.126|                      12081|
|JARED BROWN                   |                 8|               3.126|                       3138|
|JU HEE CHO                    |                10|               3.126|                      11249|
|DUY NGUYEN                    |                 3|               3.127|                        662|
|SEUNGBONG HAN                 |                 4|               3.127|                       5268|
|QIONG ZHANG                   |                 4|               3.128|                       5980|
|KRISTEN CYFFKA                |                 1|               3.129|                       1476|
|XIPEI YANG                    |                 5|               3.130|                       5031|
|CHANHAN HSU                   |                 5|               3.131|                      12600|
|TING-LI LIN                   |                 2|               3.131|                        849|
|DOUGLAS M. BATES              |                22|               3.132|                       1456|
|QUOC TRAN                     |                 8|               3.132|                       8880|
|ZUOFENG SHANG                 |                10|               3.132|                       9085|
|ALAN HUANG                    |                 1|               3.136|                        845|
|KAM-WAH TSUI                  |                41|               3.136|                       4941|
|THU LE                        |                 1|               3.136|                        845|
|CHENLIANG XU                  |                 5|               3.138|                       5301|
|HAO TENG                      |                 8|               3.139|                       5001|
|JINGLAN LI                    |                10|               3.140|                       6769|
|ZIFENG ZHAO                   |                 8|               3.140|                       5434|
|BI CHENG WU                   |                 1|               3.141|                       1602|
|RONGJUN ZHU                   |                 1|               3.141|                       1602|
|YUNONG LIN                    |                 1|               3.141|                       1068|
|BENEDEK VALKO                 |                16|               3.144|                        965|
|CHENGNING ZHANG               |                 2|               3.144|                        481|
|SEBASTIEN ROCH                |                11|               3.144|                        691|
|LILUN DU                      |                10|               3.152|                       5098|
|JOHN DAVIS                    |                11|               3.155|                       7021|
|MENG SONG                     |                 5|               3.155|                       3616|
|AKICHIKA OZEKI                |                 9|               3.157|                       4612|
|MICHAEL HOGAN                 |                 1|               3.159|                        378|
|NELLIE LAUGHLIN               |                 1|               3.159|                        378|
|KRISHNAKUMAR BALASUBRAMANIAN  |                 5|               3.161|                        540|
|TRAM TA                       |                 4|               3.162|                       5295|
|JIE WEI                       |                 2|               3.165|                       2966|
|XINJIE HE                     |                 2|               3.165|                       2966|
|XUEYAO CHEN                   |                 2|               3.165|                       2966|
|SHENG ZHANG                   |                10|               3.167|                      11274|
|ZHIGUO XIAO                   |                 4|               3.168|                       1496|
|YONGJOON KIM                  |                 2|               3.171|                       1724|
|JIAN WU                       |                 1|               3.172|                        732|
|XUN ZHAO                      |                 1|               3.172|                       2196|
|YI LI                         |                10|               3.175|                       5505|
|ROBERT WARDROP                |                28|               3.176|                      15891|
|TUN LEE NG                    |                 3|               3.176|                       1874|
|YUCHANG WU                    |                 3|               3.176|                        951|
|JIALE XU                      |                 4|               3.177|                       4771|
|WEI ZHENG                     |                 2|               3.179|                       1461|
|YILIN ZHANG                   |                 4|               3.180|                       4263|
|SHANE HUBLER                  |                 3|               3.181|                       1551|
|LU YANG                       |                 5|               3.183|                       3807|
|JIE ZHANG                     |                 9|               3.184|                      13010|
|MING XIE                      |                 4|               3.184|                       7492|
|YAOYAO XU                     |                 6|               3.184|                       4646|
|SOHEIL SADEGHI                |                 5|               3.185|                       3613|
|AUGUST JENSEN                 |                 1|               3.186|                        639|
|BIN ZHANG                     |                 2|               3.187|                        824|
|XINWEI DENG                   |                 4|               3.188|                       4441|
|JUN YIN                       |                 8|               3.190|                        477|
|YI LIU                        |                 7|               3.190|                       5080|
|BIN ZHU                       |                 7|               3.191|                       5706|
|MINJING TAO                   |                 7|               3.193|                       8284|
|RUI TANG                      |                 3|               3.193|                       3956|
|WENWEN ZHANG                  |                 9|               3.194|                       6905|
|YOURAN QI                     |                 8|               3.197|                       3977|
|CHAN PARK                     |                 2|               3.199|                       1251|
|CLAIRE BOBST                  |                 2|               3.199|                        834|
|QI TANG                       |                 8|               3.199|                       8350|
|RUNGANG HAN                   |                 2|               3.199|                       1251|
|SEAN KENT                     |                 2|               3.199|                       1251|
|COLIN LONGHURST               |                 4|               3.202|                        829|
|HAN CHEN                      |                 7|               3.204|                       2976|
|JINGJIANG PENG                |                 7|               3.204|                       3465|
|SHANG WU                      |                 5|               3.205|                       2586|
|HYEBIN SONG                   |                 8|               3.207|                       7629|
|JOHN KANE                     |                 1|               3.209|                        201|
|MARIA ROJO                    |                 2|               3.211|                       2952|
|YAN CHEN                      |                 8|               3.212|                       4742|
|FAN YANG                      |                 9|               3.214|                       4789|
|FREDERICK BOEHM               |                 9|               3.214|                       1903|
|KATHERINE GOODE               |                 2|               3.215|                       1014|
|YANG ZHAO                     |                 5|               3.215|                       6399|
|HAO ZHOU                      |                 5|               3.216|                       4934|
|NICHOLAS HENDERSON            |                 1|               3.218|                        286|
|CHAOYANG YU                   |                 3|               3.219|                       1882|
|HAO CHEN                      |                 7|               3.219|                       4458|
|MUHONG GAO                    |                 7|               3.219|                       3239|
|XIN ZHANG                     |                11|               3.219|                       4771|
|PEIGEN ZHOU                   |                 7|               3.220|                       3131|
|GONZALO CONTADOR              |                 9|               3.221|                       2128|
|TAO YU                        |                 6|               3.223|                        578|
|KAZUHIKO SHINKI               |                 2|               3.226|                       1285|
|MICHAEL KUTZLER               |                 2|               3.228|                       1721|
|FAN GAO                       |                 4|               3.230|                       2319|
|JIAJIE CHEN                   |                10|               3.232|                       4740|
|JIANCHANG HU                  |                 6|               3.234|                       3129|
|CHELSEY GREEN                 |                 3|               3.235|                       2173|
|CHIA-CHIEH LIN                |                 2|               3.235|                       1493|
|WENZHI CAO                    |                 9|               3.237|                       7465|
|SOKOL VAKO                    |                 2|               3.238|                       1700|
|CLAUDIA SOLIS LEMUS           |                 2|               3.239|                       3415|
|HAO ZHENG                     |                 6|               3.242|                       4495|
|JUN LI                        |                 4|               3.242|                       4243|
|RUOSI GUO                     |                13|               3.242|                      10187|
|SHULEI WANG                   |                 2|               3.243|                       3147|
|REBECCA POST                  |                 1|               3.245|                        513|
|YI CHAI                       |                12|               3.246|                       5963|
|DEREK NORTON                  |                 1|               3.247|                        624|
|KEEGAN KORTHAUER              |                 1|               3.247|                        208|
|ROBERT R MEYER                |                 1|               3.250|                          8|
|SIJING LI                     |                 7|               3.255|                       5217|
|DEBRAJ DAS                    |                 3|               3.257|                        540|
|QUEFENG LI                    |                 7|               3.257|                       9081|
|ABIGAIL BENZINE               |                 4|               3.260|                       3070|
|BRET HANLON                   |                29|               3.261|                       3834|
|XU XU                         |                 5|               3.261|                       2797|
|QIURONG CUI                   |                 4|               3.262|                       1664|
|ANRU ZHANG                    |                 5|               3.263|                        524|
|XIAO GUO                      |                11|               3.269|                       4692|
|DONGGYU KIM                   |                 8|               3.274|                       5830|
|TONG LI                       |                 9|               3.274|                       8452|
|HUI WANG                      |                 1|               3.287|                        556|
|KEVIN HASEGAWA ENG            |                 1|               3.287|                        834|
|XIAODAN WEI                   |                 1|               3.287|                        278|
|PAUL SAVARIAPPAN              |                 4|               3.295|                        691|
|LILI ZHENG                    |                 2|               3.297|                       2787|
|YUQING XU                     |                 7|               3.297|                       3615|
|VICTORIA MANSFIELD            |                 4|               3.299|                       2745|
|LUWAN ZHANG                   |                 5|               3.302|                       1115|
|YANNAN QIU                    |                 1|               3.304|                         28|
|JIWEI ZHAO                    |                 9|               3.307|                       1301|
|JOSEP GINEBRA                 |                 2|               3.310|                        258|
|ZHUANG WU                     |                 8|               3.312|                       8781|
|TZU HSIANG HUNG               |                 3|               3.315|                       2821|
|YONGSU LEE                    |                 4|               3.316|                       2287|
|JILI WANG                     |                 6|               3.318|                       5442|
|LIE XIONG                     |                 8|               3.318|                       3589|
|XIAOPING FENG                 |                 2|               3.318|                       2121|
|GARVESH RASKUTTI              |                21|               3.319|                        984|
|TIMOTHY IDOWU                 |                 1|               3.321|                       1002|
|XIUYU MA                      |                 5|               3.323|                       1311|
|MATTHEW BALLARD               |                 1|               3.326|                         43|
|XINXIN YU                     |                 6|               3.326|                       1740|
|BENJAMIN RECHT                |                 4|               3.331|                        185|
|SHUYUN YE                     |                 1|               3.332|                        742|
|BO YANG                       |                10|               3.334|                       3223|
|DUZHE WANG                    |                 9|               3.337|                       4024|
|JIE SONG                      |                 4|               3.337|                       4444|
|LAN LUO                       |                 1|               3.342|                       1398|
|RYAN ZEA                      |                 6|               3.347|                       3723|
|NORBERT BINKIEWICZ            |                 4|               3.353|                       1112|
|XIAOMAO LI                    |                 9|               3.361|                       4499|
|BEHZAD AALIPUR                |                 1|               3.366|                       1248|
|ALBRECHT KLEMM                |                 1|               3.368|                         19|
|SONG WANG                     |                 8|               3.373|                       6712|
|LEI XU                        |                 2|               3.379|                        604|
|DEREK BEAN                    |                 9|               3.386|                       1578|
|SHENGJI JIA                   |                16|               3.387|                       4236|
|ALYSSA DIGILIO                |                 3|               3.390|                       1052|
|KEN ONO                       |                 3|               3.394|                         78|
|LIAM JOHNSTON                 |                 6|               3.394|                       2998|
|CHENSHENG KUANG               |                 2|               3.398|                       1153|
|TING YE                       |                 2|               3.407|                        518|
|NING FAN                      |                 7|               3.410|                       3878|
|YAZHEN WANG                   |                36|               3.411|                        743|
|QING LI                       |                 5|               3.422|                       4984|
|KARL ROHE                     |                38|               3.429|                       1064|
|WEI-YIN LOH                   |                56|               3.441|                       1173|
|ROBERT WAYNE GREEN            |                 1|               3.454|                        204|
|HYUNSEUNG KANG                |                 1|               3.456|                         57|
|ANQI SHI                      |                 6|               3.460|                       3442|
|CECILE ANE                    |                38|               3.472|                       1118|
|MARI PALTA                    |                 1|               3.474|                         19|
|SHUAI CHEN                    |                 1|               3.474|                         19|
|BEHZAD AALIPUR HAFSHEJANI     |                 1|               3.475|                        180|
|JESSE THOMAS HOLZER           |                 1|               3.478|                         46|
|SUNDUZ KELES                  |                37|               3.491|                        504|
|CUICUI QI                     |                 7|               3.492|                       1483|
|COLE COOK                     |                 4|               3.510|                        716|
|ZHIGENG GENG                  |                 1|               3.512|                        846|
|ANNE BRUCKNER                 |                 1|               3.517|                        250|
|GUILHERME VIEIRA NUNES LUDWIG |                 5|               3.517|                       1447|
|EDWARD ERKER                  |                 1|               3.518|                        226|
|QI JIANG                      |                 3|               3.518|                        541|
|BRET LARGET                   |                41|               3.521|                        878|
|ERIK NORDHEIM                 |                59|               3.527|                       1060|
|JENNIFER BIRSTLER             |                 4|               3.529|                       4636|
|ZHENGJUN ZHANG                |                60|               3.531|                       1220|
|RONALD GANGNON                |                18|               3.532|                        194|
|YOUNG LEE                     |                 4|               3.534|                       4829|
|STEPHEN AARON STANHOPE        |                 2|               3.555|                        501|
|JEE YEON KIM                  |                 1|               3.571|                         56|
|CHRISTOPHER WAGNER            |                 1|               3.574|                         68|
|SHUANG HUANG                  |                 1|               3.574|                         94|
|GUANNAN SUN                   |                 2|               3.579|                        101|
|LILI LAN                      |                 3|               3.580|                       1534|
|QIAN ZHIGUANG                 |                49|               3.583|                        959|
|MURRAY CLAYTON                |                25|               3.594|                        853|
|JOHN GILLETT                  |                24|               3.606|                      13645|
|KJELL DOKSUM                  |                15|               3.609|                        145|
|KYUNGMANN KIM                 |                19|               3.612|                        198|
|SIJIAN WANG                   |                29|               3.613|                        856|
|JAMES ANDERSON                |                 1|               3.615|                         26|
|ZIJIAN NI                     |                 1|               3.616|                        138|
|ZHANG CHUNMING                |                47|               3.618|                        948|
|JUN ZHU                       |                33|               3.619|                        449|
|THOMAS COOK                   |                 8|               3.627|                        134|
|JUNHO LEE                     |                 1|               3.643|                         28|
|HUAIBAO FENG                  |                 2|               3.645|                         38|
|MICHELLE HARRIS               |                 1|               3.647|                         41|
|MARY LINDSTROM                |                 7|               3.661|                        273|
|YUAN LI                       |                 5|               3.671|                       2638|
|NORMAN DRAPER                 |                 2|               3.680|                         25|
|MOO K CHUNG                   |                18|               3.682|                         11|
|THEVAASIINEN CHANDERENG       |                 2|               3.692|                       1106|
|YANBING ZHENG                 |                 1|               3.692|                         13|
|JUN SHAO                      |                46|               3.695|                        608|
|PAUL RATHOUZ                  |                 8|               3.695|                        381|
|JASON P FINE                  |                 5|               3.719|                         16|
|JOSEPH DEUTSCH                |                 4|               3.723|                       1971|
|CHRISTINA M. KENDZIORSKI      |                30|               3.725|                        108|
|ADIN-CRISTIAN ANDREI          |                 7|               3.749|                        164|
|KARL BROMAN                   |                16|               3.762|                        348|
|RICHARD J. CHAPPELL           |                41|               3.765|                        275|
|REBECCA KOSCIK                |                 3|               3.772|                        990|
|FANGFANG WANG                 |                 2|               3.773|                         56|
|SHAN LU                       |                 1|               3.775|                        254|
|MICHAEL NEWTON                |                38|               3.790|                        254|
|BRIAN YANDELL                 |                37|               3.799|                        119|
|MICHAEL LIOU                  |                 1|               3.814|                        177|
|DAVID DEMETS                  |                 3|               3.833|                         21|
|LU MAO                        |                 3|               3.910|                         51|
|MING YUAN                     |                 8|               3.925|                         68|
|CHAOQUN MEI                   |                 2|               3.938|                         97|
|YU MENGGANG                   |                13|               3.939|                        109|
|GRACE WAHBA                   |                31|               3.973|                        156|
|GUANHUA CHEN                  |                 1|               4.000|                         16|
|SRIKANTHMADHAVAN ARAVAMUTHAN  |                 1|               4.000|                         16|
|YAJUAN SI                     |                 3|               4.000|                         46|

 Professor considerado MAIS DIFÍCIL:
- JAMES D KUELBS (GPA médio = 2.60)

 Professor considerado MAIS FÁCIL:
- GUANHUA CHEN (GPA médio = 4.00)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Atividade 3 concluída em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Atividade 3 concluída em: 21:17:09 </code></pre>
</div>
</div>
</section>
<section id="resumo-final" class="level2">
<h2 class="anchored" data-anchor-id="resumo-final">Resumo Final</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular tempo total de execução</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fim_analise <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>tempo_total <span class="ot">&lt;-</span> <span class="fu">difftime</span>(fim_analise, inicio_analise, <span class="at">units =</span> <span class="st">"secs"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== RESUMO FINAL ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== RESUMO FINAL ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Análise concluída em:"</span>, <span class="fu">format</span>(fim_analise, <span class="st">'%d/%m/%Y às %H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Análise concluída em: 24/09/2025 às 21:17:09 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tempo total de execução:"</span>, <span class="fu">round</span>(<span class="fu">as.numeric</span>(tempo_total), <span class="dv">2</span>), <span class="st">"segundos</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tempo total de execução: 7.53 segundos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">" Código analisado: %s</span><span class="sc">\n</span><span class="st">"</span>, codigo_estatistica))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Código analisado: 932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"professores_stat"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(professores_stat) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"professores identificados: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(professores_stat)))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>professores identificados: 379</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"dados_gpa"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(dados_gpa) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Oferecimentos com GPA: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(dados_gpa)))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  gpas <span class="ot">&lt;-</span> dados_gpa<span class="sc">$</span>gpa_medio[<span class="sc">!</span><span class="fu">is.na</span>(dados_gpa<span class="sc">$</span>gpa_medio)]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(gpas) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"GPA médio geral: %.3f (variação: %.3f - %.3f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(gpas), <span class="fu">min</span>(gpas), <span class="fu">max</span>(gpas)))</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oferecimentos com GPA: 1057
GPA médio geral: 3.356 (variação: 2.305 - 4.000)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"ranking_professores"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(ranking_professores) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Professores ranqueados: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(ranking_professores)))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  gpas_prof <span class="ot">&lt;-</span> ranking_professores<span class="sc">$</span>gpa_medio_professor[<span class="sc">!</span><span class="fu">is.na</span>(ranking_professores<span class="sc">$</span>gpa_medio_professor)]</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(gpas_prof) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    diff_gpa <span class="ot">&lt;-</span> <span class="fu">max</span>(gpas_prof) <span class="sc">-</span> <span class="fu">min</span>(gpas_prof)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Maior diferença de GPA entre professores: %.3f pontos</span><span class="sc">\n</span><span class="st">"</span>, diff_gpa))</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Professores ranqueados: 379
Maior diferença de GPA entre professores: 1.401 pontos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> ANÁLISE CONCLUÍDA COM SUCESSO!</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ANÁLISE CONCLUÍDA COM SUCESSO!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Documento gerado em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%d de %B de %Y às %H:%M:%S (%Z)'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Documento gerado em: 24 de setembro de 2025 às 21:17:09 (-03) </code></pre>
</div>
</div>
</section>
<section id="desconexão" class="level2">
<h2 class="anchored" data-anchor-id="desconexão">Desconexão</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"conn"</span>) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(conn)) {</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbDisconnect</span>(conn)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"conexão encerrada em:"</span>, <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">'%H:%M:%S'</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>conexão encerrada em: 21:17:09 </code></pre>
</div>
</div>
<hr>
<p><em>Este documento foi gerado automaticamente em 24 de setembro de 2025 às 21:17:09 (-03)</em></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>